{"remainingRequest":"/Users/xmg/Desktop/前端知识/13期/Day 04/mall/node_modules/babel-loader/lib/index.js!/Users/xmg/Desktop/前端知识/13期/Day 04/mall/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/xmg/Desktop/前端知识/13期/Day 04/mall/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/xmg/Desktop/前端知识/13期/Day 04/mall/src/views/category/Category.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/xmg/Desktop/前端知识/13期/Day 04/mall/src/views/category/Category.vue","mtime":1543563471000},{"path":"/Users/xmg/Desktop/前端知识/13期/Day 04/mall/node_modules/cache-loader/dist/cjs.js","mtime":1541055698000},{"path":"/Users/xmg/Desktop/前端知识/13期/Day 04/mall/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/xmg/Desktop/前端知识/13期/Day 04/mall/node_modules/cache-loader/dist/cjs.js","mtime":1541055698000},{"path":"/Users/xmg/Desktop/前端知识/13期/Day 04/mall/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import _objectSpread from \"/Users/xmg/Desktop/\\u524D\\u7AEF\\u77E5\\u8BC6/13\\u671F/Day 04/mall/node_modules/@babel/runtime/helpers/esm/objectSpread\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport NavBar from 'components/common/navbar/NavBar';\nimport TabMenu from './childComps/TabMenu';\nimport TabContentCategory from './childComps/TabContentCategory';\nimport TabControl from 'components/content/tabControl/TabControl';\nimport Scroll from 'components/common/scroll/Scroll';\nimport GoodsList from 'components/content/goods/GoodsList';\nimport { getCategory, getSubcategory, getCategoryDetail } from \"network/category\";\nimport { POP, SELL, NEW } from \"common/const\";\nimport { tabControlMixin } from \"@/common/mixin\";\nexport default {\n  name: \"Category\",\n  components: {\n    NavBar: NavBar,\n    TabMenu: TabMenu,\n    TabControl: TabControl,\n    Scroll: Scroll,\n    TabContentCategory: TabContentCategory,\n    GoodsList: GoodsList\n  },\n  mixins: [tabControlMixin],\n  data: function data() {\n    return {\n      categories: [],\n      categoryData: {},\n      currentIndex: -1\n    };\n  },\n  created: function created() {\n    var _this = this;\n\n    // 1.请求分类数据\n    this._getCategory(); // 2.监听图片加载完成\n\n\n    this.$bus.$on('imgLoad', function () {\n      _this.$refs.scroll.refresh();\n    });\n  },\n  computed: {\n    showSubcategory: function showSubcategory() {\n      if (this.currentIndex === -1) return {};\n      return this.categoryData[this.currentIndex].subcategories;\n    },\n    showCategoryDetail: function showCategoryDetail() {\n      if (this.currentIndex === -1) return [];\n      return this.categoryData[this.currentIndex].categoryDetail[this.currentType];\n    }\n  },\n  methods: {\n    _getCategory: function _getCategory() {\n      var _this2 = this;\n\n      getCategory().then(function (res) {\n        // 1.获取分类数据\n        _this2.categories = res.data.category.list;\n        console.log(res); // 2.初始化每个类别的子数据\n\n        for (var i = 0; i < _this2.categories.length; i++) {\n          _this2.categoryData[i] = {\n            subcategories: {},\n            categoryDetail: {\n              'pop': [],\n              'new': [],\n              'sell': []\n            }\n          };\n        } // 3.请求第一个分类的数据\n\n\n        _this2._getSubcategories(0);\n      });\n    },\n    _getSubcategories: function _getSubcategories(index) {\n      var _this3 = this;\n\n      this.currentIndex = index;\n      var mailKey = this.categories[index].maitKey;\n      getSubcategory(mailKey).then(function (res) {\n        _this3.categoryData[index].subcategories = res.data;\n        _this3.categoryData = _objectSpread({}, _this3.categoryData);\n\n        _this3._getCategoryDetail(POP);\n\n        _this3._getCategoryDetail(SELL);\n\n        _this3._getCategoryDetail(NEW);\n      });\n    },\n    _getCategoryDetail: function _getCategoryDetail(type) {\n      var _this4 = this;\n\n      // 1.获取请求的miniWallkey\n      var miniWallkey = this.categories[this.currentIndex].miniWallkey; // 2.发送请求,传入miniWallkey和type\n\n      getCategoryDetail(miniWallkey, type).then(function (res) {\n        // 3.将获取的数据保存下来\n        _this4.categoryData[_this4.currentIndex].categoryDetail[type] = res;\n        _this4.categoryData = _objectSpread({}, _this4.categoryData);\n      });\n    },\n\n    /**\n     * 事件响应相关的方法\n     */\n    selectItem: function selectItem(index) {\n      this._getSubcategories(index);\n    }\n  }\n};",{"version":3,"sources":["Category.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div id=\"category\">\n    <nav-bar class=\"nav-bar\"><div slot=\"center\">商品分类</div></nav-bar>\n    <div class=\"content\">\n      <tab-menu :categories=\"categories\"\n                @selectItem=\"selectItem\"/>\n\n      <scroll id=\"tab-content\"\n              :data=\"[categoryData]\"\n              ref=\"scroll\">\n        <div>\n          <tab-content-category :subcategories=\"showSubcategory\"/>\n          <tab-control :titles=\"['综合', '新品', '销量']\"\n                       @itemClick=\"tabClick\"/>\n          <goods-list :goods=\"showCategoryDetail\"/>\n        </div>\n      </scroll>\n    </div>\n  </div>\n</template>\n\n<script>\n  import NavBar from 'components/common/navbar/NavBar'\n\n  import TabMenu from './childComps/TabMenu'\n  import TabContentCategory from './childComps/TabContentCategory'\n\n\n  import TabControl from 'components/content/tabControl/TabControl'\n  import Scroll from 'components/common/scroll/Scroll'\n  import GoodsList from 'components/content/goods/GoodsList'\n\n  import {getCategory, getSubcategory, getCategoryDetail} from \"network/category\";\n  import {POP, SELL, NEW} from \"common/const\";\n  import {tabControlMixin} from \"@/common/mixin\";\n\n  export default {\n\t\tname: \"Category\",\n    components: {\n\t\t  NavBar,\n      TabMenu,\n      TabControl,\n      Scroll,\n      TabContentCategory,\n      GoodsList\n    },\n    mixins: [tabControlMixin],\n    data() {\n\t\t  return {\n\t\t    categories: [],\n        categoryData: {\n        },\n        currentIndex: -1\n      }\n    },\n    created() {\n\t\t  // 1.请求分类数据\n      this._getCategory()\n\n      // 2.监听图片加载完成\n\t    this.$bus.$on('imgLoad', () => {\n\t\t    this.$refs.scroll.refresh()\n\t    })\n    },\n    computed: {\n\t\t  showSubcategory() {\n\t\t    if (this.currentIndex === -1) return {}\n        return this.categoryData[this.currentIndex].subcategories\n      },\n      showCategoryDetail() {\n\t\t    if (this.currentIndex === -1) return []\n\t\t    return this.categoryData[this.currentIndex].categoryDetail[this.currentType]\n      }\n    },\n    methods: {\n\t\t  _getCategory() {\n\t\t    getCategory().then(res => {\n\t\t      // 1.获取分类数据\n\t\t      this.categories = res.data.category.list\n\t\t\t    console.log(res);\n\t\t\t    // 2.初始化每个类别的子数据\n          for (let i = 0; i < this.categories.length; i++) {\n            this.categoryData[i] = {\n              subcategories: {},\n              categoryDetail: {\n                'pop': [],\n                'new': [],\n                'sell': []\n              }\n            }\n          }\n          // 3.请求第一个分类的数据\n          this._getSubcategories(0)\n        })\n      },\n      _getSubcategories(index) {\n        this.currentIndex = index;\n\t\t    const mailKey = this.categories[index].maitKey;\n        getSubcategory(mailKey).then(res => {\n          this.categoryData[index].subcategories = res.data\n          this.categoryData = {...this.categoryData}\n          this._getCategoryDetail(POP)\n          this._getCategoryDetail(SELL)\n          this._getCategoryDetail(NEW)\n        })\n      },\n      _getCategoryDetail(type) {\n\t\t    // 1.获取请求的miniWallkey\n        const miniWallkey = this.categories[this.currentIndex].miniWallkey;\n        // 2.发送请求,传入miniWallkey和type\n\t\t    getCategoryDetail(miniWallkey, type).then(res => {\n\t\t      // 3.将获取的数据保存下来\n\t\t      this.categoryData[this.currentIndex].categoryDetail[type] = res\n          this.categoryData = {...this.categoryData}\n        })\n      },\n      /**\n       * 事件响应相关的方法\n       */\n      selectItem(index) {\n        this._getSubcategories(index)\n      }\n    }\n\t}\n</script>\n\n<style scoped>\n  #category {\n    height: 100vh;\n  }\n\n  .nav-bar {\n    background-color: var(--color-tint);\n    font-weight: 700;\n    color: #fff;\n  }\n\n  .content {\n    position: absolute;\n    left: 0;\n    right: 0;\n    top: 44px;\n    bottom: 49px;\n\n    display: flex;\n  }\n\n  #tab-content {\n    height: 100%;\n    flex: 1;\n  }\n</style>\n"],"sourceRoot":"src/views/category"}]}